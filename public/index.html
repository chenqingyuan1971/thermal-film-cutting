<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>玻璃隔热膜裁切优化系统 V3.3.14</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="/js/app.js?v=3.3.17"></script>
    <style>
        :root {
            --primary-red: #BA1B25;
            --primary-red-dark: #8B1419;
            --secondary-gray: #373737;
            --aux-light-blue: #f8f9fa;
            --aux-deep-blue: #f8f9fa;
            --aux-light-tan: #f8f9fa;
            --aux-smoke-gray: #6c757d;
            --aux-pale-gray: #e9ecef;
        }
        
        .bg-primary-red { background: var(--primary-red); }
        .bg-primary-gradient { background: linear-gradient(to right, var(--primary-red), var(--primary-red-dark)); }
        .text-primary-red { color: var(--primary-red); }
        .border-primary-red { border-color: var(--primary-red); }
        .bg-light-blue { background: var(--aux-light-blue); }
        .bg-deep-blue { background: var(--aux-deep-blue); }
        .bg-light-tan { background: var(--aux-light-tan); }
        .bg-smoke-gray { background: var(--aux-smoke-gray); }
        .bg-pale-gray { background: var(--aux-pale-gray); }
        .border-light-blue { border-color: var(--aux-light-blue); }
        .border-deep-blue { border-color: var(--aux-deep-blue); }
        .border-light-tan { border-color: var(--aux-light-tan); }
        .text-light-blue-dark { color: #495057; }
        .text-deep-blue-dark { color: #495057; }
        .text-light-tan-dark { color: #495057; }
        .btn-primary:hover { background: var(--primary-red-dark); }
        .btn-secondary:hover { background: var(--aux-smoke-gray); }
        .btn-tan:hover { background: #c9b189; }
        .input-focus:focus { border-color: var(--primary-red); outline: none; }
        
        /* ==================== 移动端适配样式 ==================== */
        @media screen and (max-width: 768px) {
            /* 基础调整 */
            html {
                font-size: 14px;
            }
            
            body {
                padding-bottom: 80px;
            }
            
            .container {
                padding-left: 12px !important;
                padding-right: 12px !important;
            }
            
            /* 标题卡片 */
            .bg-primary-gradient.rounded-2xl {
                padding: 1.5rem !important;
            }
            
            .bg-primary-gradient h1 {
                font-size: 1.5rem !important;
            }
            
            .bg-primary-gradient .logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .bg-primary-gradient .logo-icon {
                margin-right: 0 !important;
                margin-bottom: 0.5rem;
                width: 3rem !important;
                height: 3rem !important;
            }
            
            /* 导航栏 */
            #authNavUser {
                flex-wrap: wrap;
                justify-content: center;
                gap: 0.5rem !important;
            }
            
            #authNavUser button {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.875rem;
            }
            
            /* 表单网格 - 单列布局 */
            .grid {
                grid-template-columns: 1fr !important;
                gap: 0.75rem !important;
            }
            
            .grid-cols-2,
            .grid-cols-3,
            .grid-cols-4,
            .grid-cols-5 {
                grid-template-columns: 1fr !important;
            }
            
            /* 输入框优化 */
            input[type="text"],
            input[type="number"],
            select,
            textarea {
                font-size: 16px !important; /* 防止iOS自动缩放 */
                height: 44px !important;
                padding: 0.75rem !important;
            }
            
            textarea {
                min-height: 80px !important;
            }
            
            /* 标签样式 */
            label {
                font-size: 0.875rem;
                margin-bottom: 0.25rem !important;
            }
            
            /* 卡片样式 */
            .rounded-2xl {
                border-radius: 0.75rem !important;
            }
            
            .shadow-xl,
            .shadow-2xl {
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
            }
            
            /* 按钮全宽 */
            button.w-full {
                width: 100% !important;
                margin-bottom: 0.5rem;
            }
            
            /* 模态框适配 */
            .fixed.inset-0.bg-black.bg-opacity-50 {
                padding: 1rem;
                align-items: flex-start;
                padding-top: 5%;
            }
            
            .fixed.inset-0.bg-black.bg-opacity-50 > div {
                width: 95% !important;
                max-height: 85vh !important;
                overflow-y: auto;
                margin: 0 auto;
            }
            
            .rounded-t-2xl {
                border-top-left-radius: 0.75rem !important;
                border-top-right-radius: 0.75rem !important;
            }
            
            /* 模态框按钮 */
            .fixed.inset-0.bg-black.bg-opacity-50 + div {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .fixed.inset-0.bg-black.bg-opacity-50 + div button {
                flex: none !important;
                width: 100%;
                padding: 0.75rem !important;
            }
            
            /* 表格响应式 */
            .overflow-x-auto {
                margin: 0 -12px;
                padding: 0 12px;
            }
            
            /* 项目卡片 */
            .bg-white.border-2.border-gray-200.rounded-xl.p-4 {
                padding: 1rem !important;
            }
            
            /* Logo卡片 */
            .logo-card {
                flex-direction: column;
                text-align: center;
                gap: 0.5rem !important;
                padding: 1rem !important;
            }
            
            .logo-placeholder {
                width: 80px !important;
                height: 80px !important;
            }
            
            .company-name {
                font-size: 1.125rem !important;
            }
            
            .company-subtitle {
                font-size: 0.875rem !important;
            }
            
            /* 历史记录模态框内容 */
            .bg-white.rounded-2xl.shadow-2xl {
                max-height: 80vh !important;
                overflow-y: auto;
            }
            
            /* 通知容器位置调整 */
            .fixed.top-20.right-4 {
                top: 1rem !important;
                right: 0.5rem !important;
                left: 0.5rem;
            }
            
            /* 下拉菜单优化 */
            .absolute.right-0.mt-2.w-48 {
                right: -50%;
                left: auto;
            }
        }
        
        /* 小屏幕额外优化 */
        @media screen and (max-width: 480px) {
            .bg-primary-gradient {
                padding: 1rem !important;
            }
            
            .bg-primary-gradient h1 {
                font-size: 1.25rem !important;
            }
            
            h2.text-2xl {
                font-size: 1.25rem !important;
            }
            
            h3.text-lg {
                font-size: 1rem !important;
            }
            
            .text-lg {
                font-size: 1rem !important;
            }
            
            .text-sm {
                font-size: 0.75rem !important;
            }
            
            .text-xs {
                font-size: 0.65rem !important;
            }
            
            .p-6 {
                padding: 1rem !important;
            }
            
            .p-8 {
                padding: 1.25rem !important;
            }
            
            .mb-8 {
                margin-bottom: 1.5rem !important;
            }
            
            .gap-4 {
                gap: 0.75rem !important;
            }
        }
        
        /* ==================== 触摸设备优化 ==================== */
        @media (hover: none) and (pointer: coarse) {
            /* 触摸设备上增加触摸目标尺寸 */
            button,
            [role="button"] {
                min-height: 44px;
                min-width: 44px;
            }
            
            /* 移除悬停效果（触摸设备不支持） */
            button:active {
                transform: scale(0.98);
            }
            
            /* 触摸友好的下拉菜单 */
            .group:hover .absolute {
                display: none;
            }
            
            .group:focus-within .absolute {
                display: block;
            }
        }
        
        .bg-vi-gradient { 
            background: #f5f5f5; 
        }
        
        /* Logo卡片样式 */
        .logo-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2rem;
        }
        
        .logo-placeholder {
            width: 120px;
            height: 120px;
            border: none;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            flex-shrink: 0;
        }
        
        .logo-placeholder img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .company-info {
            text-align: center;
        }
        
        .company-name {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-red);
            margin-bottom: 0.3rem;
        }
        
        .company-subtitle {
            font-size: 1.5rem;
            color: #999;
            letter-spacing: 0.1em;
        }
        
        /* 玻璃列表滚动容器样式 */
        #glassList {
            display: block !important;
            max-height: 500px !important;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-red) #f1f1f1;
        }
        
        /* Webkit浏览器滚动条样式 - 竖向 */
        #glassList::-webkit-scrollbar {
            width: 12px;
        }
        
        #glassList::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }
        
        #glassList::-webkit-scrollbar-thumb {
            background: var(--primary-red);
            border-radius: 6px;
            border: 2px solid #f1f1f1;
        }
        
        #glassList::-webkit-scrollbar-thumb:hover {
            background: var(--primary-red-dark);
        }
        
        /* 滚动容器内部表格的横向滚动条 */
        #glassList .overflow-x-auto {
            overflow-x: auto !important;
            overflow-y: visible !important;
            scrollbar-width: thin;
            scrollbar-color: #999 #f1f1f1;
            padding-bottom: 4px;
        }
        
        #glassList .overflow-x-auto::-webkit-scrollbar {
            height: 12px;
        }
        
        #glassList .overflow-x-auto::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }
        
        #glassList .overflow-x-auto::-webkit-scrollbar-thumb {
            background: #999;
            border-radius: 6px;
            border: 2px solid #f1f1f1;
        }
        
        #glassList .overflow-x-auto::-webkit-scrollbar-thumb:hover {
            background: #666;
        }
        
        /* 移动端优化 - 增强版 */
        @media (max-width: 768px) {
            /* 基础字体和间距调整 */
            body {
                font-size: 14px;
                -webkit-overflow-scrolling: touch; /* iOS平滑滚动 */
                -webkit-tap-highlight-color: rgba(186, 27, 37, 0.1); /* 触摸高亮 */
            }
            
            /* 容器padding调整 */
            .max-w-7xl {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
            
            /* 标题尺寸 */
            h1 {
                font-size: 1.5rem !important;
                line-height: 1.3 !important;
            }
            
            h2 {
                font-size: 1.25rem !important;
                line-height: 1.3 !important;
            }
            
            h3 {
                font-size: 1.1rem !important;
                line-height: 1.3 !important;
            }
            
            /* Logo卡片移动端调整 */
            .logo-card {
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }
            
            .logo-placeholder {
                width: 60px;
                height: 60px;
            }
            
            .company-name {
                font-size: 1.2rem;
            }
            
            .company-subtitle {
                font-size: 1.1rem;
            }
            
            /* 输入框优化 - 增大触摸区域并防止iOS缩放 */
            input[type="text"],
            input[type="number"],
            input[type="tel"],
            select,
            textarea {
                min-height: 44px !important;
                font-size: 16px !important; /* 防止iOS自动缩放 */
                padding: 0.75rem !important;
                -webkit-appearance: none;
                appearance: none;
            }
            
            /* 数字输入框特殊处理 */
            input[type="number"] {
                -moz-appearance: textfield;
            }
            
            input[type="number"]::-webkit-inner-spin-button,
            input[type="number"]::-webkit-outer-spin-button {
                -webkit-appearance: none;
                margin: 0;
            }
            
            /* 按钮优化 - 确保足够的触摸区域 */
            button {
                min-height: 44px !important;
                padding: 0.75rem 1rem !important;
                font-size: 14px !important;
                touch-action: manipulation; /* 优化触摸响应 */
                -webkit-user-select: none;
                user-select: none;
            }
            
            /* 小按钮也要保证最小触摸尺寸 */
            button.text-xs,
            button.text-sm {
                min-height: 40px !important;
                padding: 0.5rem 0.75rem !important;
            }
            
            /* 表格单元格 */
            table th, table td {
                padding: 0.5rem 0.25rem !important;
                font-size: 0.75rem !important;
                white-space: nowrap;
            }
            
            /* 统计卡片 - 2列显示 */
            #totalStats {
                padding: 1rem !important;
            }
            
            #totalStats .grid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.5rem !important;
            }
            
            #totalStats .bg-gray-200 {
                padding: 0.5rem !important;
                min-height: 80px;
            }
            
            #totalStats .font-bold {
                font-size: 1.2rem !important;
            }
            
            /* 产品分类统计 - 2列显示 */
            #productStats {
                padding: 1rem !important;
            }
            
            #productStats .grid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0.5rem !important;
            }
            
            #productStats .border-4 {
                padding: 1rem !important;
                margin-bottom: 1rem !important;
                border-width: 3px !important;
            }
            
            /* Logo区域 */
            .logo-container {
                flex-direction: column !important;
                gap: 0.5rem !important;
                text-align: center !important;
            }
            
            /* 主标题卡片 */
            .bg-primary-gradient {
                padding: 1.5rem 1rem !important;
            }
            
            /* 玻璃列表容器 */
            #glassList {
                max-height: 400px !important;
                -webkit-overflow-scrolling: touch;
            }
            
            /* 滚动条在移动端变细 */
            #glassList::-webkit-scrollbar {
                width: 6px;
            }
            
            #glassList .overflow-x-auto::-webkit-scrollbar {
                height: 6px;
            }
            
            /* 方案选择卡片 */
            #sixPlansDisplay {
                grid-template-columns: repeat(1, 1fr) !important;
            }
            
            /* 模态框移动端优化 */
            #planModal > div {
                width: 95% !important;
                max-width: 95% !important;
                margin: 0.5rem !important;
                max-height: 90vh !important;
                overflow-y: auto !important;
                padding: 1rem !important;
            }
            
            #planModal .space-y-4 {
                max-height: 60vh !important;
                overflow-y: auto !important;
            }
            
            /* 底部操作按钮区域 */
            .flex.gap-2,
            .flex.gap-3,
            .flex.gap-4 {
                flex-wrap: wrap;
                gap: 0.5rem !important;
            }
            
            .flex.gap-3 button {
                flex: 1 1 auto;
                min-width: calc(50% - 0.25rem);
            }
            
            /* 隐藏打印按钮在移动端 */
            button[onclick*="printReport"] {
                display: none !important;
            }
            
            /* SVG示意图 */
            svg {
                max-width: 100% !important;
                height: auto !important;
            }
            
            /* 卡片内边距优化 */
            .rounded-2xl,
            .p-6,
            .p-8 {
                padding: 1rem !important;
            }
            
            /* 表单网格布局 */
            .grid.gap-4 {
                gap: 0.75rem !important;
            }
            
            /* 网格布局自动调整 */
            .grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr)) !important;
            }
            
            .md\:grid-cols-3,
            .lg\:grid-cols-6 {
                grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
            }
            
            /* 间距调整 */
            .space-y-6 > * + * {
                margin-top: 1rem !important;
            }
            
            .space-y-4 > * + * {
                margin-top: 0.75rem !important;
            }
            
            /* 响应式文字大小 */
            .text-xl {
                font-size: 1.1rem !important;
            }
            
            .text-2xl {
                font-size: 1.3rem !important;
            }
            
            .text-3xl {
                font-size: 1.5rem !important;
            }
            
            /* 强制覆盖卡片间距 */
            .logo-card {
                margin-bottom: 0.25rem !important; /* 与下方卡片的间距 */
            }
            
            .bg-primary-gradient {
                margin-bottom: 0.25rem !important; /* 与下方卡片的间距 */
            }
            
            .bg-white.rounded-2xl {
                margin-bottom: 0.25rem !important; /* 所有白色卡片与下方的间距 */
            }
        }
        
        /* 超小屏幕优化 (iPhone SE等, <375px) */
        @media (max-width: 375px) {
            body {
                font-size: 13px;
            }
            
            .max-w-7xl {
                padding-left: 0.5rem;
                padding-right: 0.5rem;
            }
            
            h1 {
                font-size: 1.25rem !important;
            }
            
            h2 {
                font-size: 1.1rem !important;
            }
            
            .company-name {
                font-size: 1.1rem;
            }
            
            .company-subtitle {
                font-size: 1rem;
            }
            
            button {
                font-size: 13px !important;
                padding: 0.6rem 0.75rem !important;
            }
            
            .grid > div {
                padding: 0.75rem !important;
            }
            
            #glassList table {
                font-size: 12px;
            }
            
            /* 统计卡片标题字号 */
            #totalStats .text-xs,
            #productStats .font-semibold {
                font-size: 0.65rem !important;
            }
            
            /* 统计数值字号 */
            #totalStats .font-bold,
            #productStats .font-bold {
                font-size: 1.1rem !important;
            }
            
            /* Logo */
            .logo-icon {
                width: 50px !important;
                height: 50px !important;
            }
            
            /* 主标题 */
            .main-title {
                font-size: 1.2rem !important;
            }
            
            /* 输入区域网格 */
            .grid-cols-1.md\:grid-cols-2 {
                grid-template-columns: repeat(1, 1fr) !important;
            }
            
            /* 快捷按钮 */
            .quick-action-buttons {
                flex-wrap: wrap !important;
            }
            
            .quick-action-buttons button {
                flex: 1 1 45% !important;
                min-width: 45% !important;
            }
        }
        
        /* 横屏模式优化 */
        @media (max-width: 768px) and (orientation: landscape) {
            #glassList {
                max-height: 300px !important;
            }
            
            #planModal > div {
                max-height: 85vh !important;
            }
            
            .logo-card {
                flex-direction: row !important;
                gap: 1rem;
            }
        }
        
        /* 触摸优化 - 针对触摸屏设备 */
        @media (hover: none) and (pointer: coarse) {
            /* 增大所有可点击元素的最小尺寸 */
            button, a, input, select {
                min-height: 48px;
            }
            
            /* 移除hover效果（触摸屏不需要） */
            button:hover, a:hover {
                transform: none !important;
                opacity: 1 !important;
            }
            
            /* 添加触摸反馈 - 按下时的视觉反馈 */
            button:active, a:active {
                opacity: 0.7;
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }
            
            /* 输入框焦点优化 */
            input:focus,
            select:focus,
            textarea:focus {
                border-color: var(--primary-red);
                box-shadow: 0 0 0 3px rgba(186, 27, 37, 0.1);
            }
        }
        
        /* 全局强制覆盖卡片间距 - 对所有屏幕尺寸生效 */
        .logo-card {
            margin-bottom: 0.5rem !important;
        }
        
        .container > .bg-primary-gradient,
        .container > .bg-white.rounded-2xl {
            margin-bottom: 0.5rem !important;
        }
        
        /* 打印样式 */
        @media print {
            /* 打印时隐藏滚动条 */
            #glassList,
            #glassList .overflow-x-auto {
                overflow: visible !important;
                max-height: none !important;
            }
            
            /* 所有页面横向打印，并隐藏页眉页脚 */
            @page {
                size: A4 landscape;
                margin: 10mm;
                /* 隐藏页眉页脚 */
                margin-top: 0;
                margin-bottom: 0;
            }
            
            /* 首页 */
            @page :first {
                margin-top: 10mm;
            }
            
            /* 重置body */
            body {
                background: white !important;
                margin: 0 !important;
                padding: 0 !important;
                /* 确保内容从顶部开始 */
                padding-top: 0 !important;
            }
            
            /* 隐藏所有非打印内容 */
            body > *:not(.print-section) {
                display: none !important;
            }
            
            /* 显示打印区域 */
            .print-section {
                display: block !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            .print-section * {
                visibility: visible !important;
            }
            
            /* 表格元素 */
            .print-section table {
                display: table !important;
                width: 100% !important;
            }
            
            .print-section thead {
                display: table-header-group !important;
            }
            
            .print-section tbody {
                display: table-row-group !important;
            }
            
            .print-section tr {
                display: table-row !important;
            }
            
            .print-section th,
            .print-section td {
                display: table-cell !important;
            }
            
            /* flex和grid布局 - 重要！ */
            .print-section .print-flex {
                display: flex !important;
            }
            
            .print-section .print-grid {
                display: grid !important;
            }
            
            /* SVG */
            .print-section svg {
                display: inline-block !important;
            }
            
            /* 第1页：项目详情 - 严格控制高度 */
            .print-page-1 {
                page-break-after: always !important;
                page-break-inside: avoid !important;
                max-height: 170mm !important;
                overflow: hidden !important;
            }
            
            /* 第2页：统计 */
            .print-page-stats {
                page-break-before: always !important;
                page-break-after: always !important;
            }
            
            /* 产品分类卡片 - 避免分页断裂 */
            .print-product-card {
                page-break-inside: avoid !important;
                page-break-after: auto !important;
                margin-bottom: 8px !important;
                padding: 0.7rem !important;
            }
            
            /* 打印时产品分类统计卡片内容紧凑化 */
            .print-product-card h3 {
                font-size: 0.9rem !important;
                margin-bottom: 0.4rem !important;
            }
            
            .print-product-card h3 span:first-child {
                padding: 0.3rem 0.6rem !important;
                font-size: 0.85rem !important;
            }
            
            .print-product-card h3 span:last-child {
                font-size: 0.85rem !important;
            }
            
            .print-product-card .grid {
                gap: 0.3rem !important;
            }
            
            .print-product-card .bg-gray-200 {
                padding: 0.4rem !important;
            }
            
            .print-product-card .bg-gray-200 div:first-child {
                font-size: 0.6rem !important;
                margin-bottom: 0.2rem !important;
            }
            
            .print-product-card .bg-gray-200 div:last-child {
                font-size: 1rem !important;
            }
            
            .print-product-card .bg-gray-200 div:last-child span {
                font-size: 0.7rem !important;
            }
            
            /* 第3页：详细表格 */
            .print-page-details {
                page-break-before: always !important;
            }
            
            .print-page-details table {
                page-break-inside: auto !important;
            }
            
            .print-page-details tr {
                page-break-inside: avoid !important;
                page-break-after: auto !important;
            }
            
            .print-page-details thead {
                display: table-header-group !important;
            }
            
            /* 确保颜色显示 */
            * {
                color-adjust: exact !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.bottom-0{bottom:0px}.top-0{top:0px}.right-3{right:0.75rem}.top-3{top:0.75rem}.z-10{z-index:10}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-top:1rem;margin-bottom:1rem}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:0.25rem}.mr-2{margin-right:0.5rem}.mr-3{margin-right:0.75rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-5{height:1.25rem}.h-8{height:2rem}.h-4{height:1rem}.h-6{height:1.5rem}.max-h-\[95vh\]{max-height:95vh}.min-h-screen{min-height:100vh}.w-10{width:2.5rem}.w-5{width:1.25rem}.w-8{width:2rem}.w-full{width:100%}.w-4{width:1rem}.w-6{width:1.5rem}.min-w-0{min-width:0px}.max-w-7xl{max-width:80rem}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.border-collapse{border-collapse:collapse}.cursor-pointer{cursor:pointer}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.flex-wrap{flex-wrap:wrap}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:0.25rem}.rounded-2xl{border-radius:1rem}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.rounded-full{border-radius:9999px}.rounded-t-2xl{border-top-left-radius:1rem;border-top-right-radius:1rem}.border{border-width:1px}.border-2{border-width:2px}.border-4{border-width:4px}.border-l-4{border-left-width:4px}.border-t-2{border-top-width:2px}.border-b{border-bottom-width:1px}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-yellow-500{--tw-border-opacity:1;border-color:rgb(234 179 8 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity:1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-yellow-400{--tw-border-opacity:1;border-color:rgb(250 204 21 / var(--tw-border-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity:1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-orange-100{--tw-bg-opacity:1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-yellow-100{--tw-bg-opacity:1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity:0.5}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-8{padding-top:2rem;padding-bottom:2rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-1\.5{padding-top:0.375rem;padding-bottom:0.375rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-gray-800{display:none;}.text-gray-800{--tw-text-opacity:1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity:1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-gray-700{display:none;}.text-gray-700{--tw-text-opacity:1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.opacity-90{opacity:0.9}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-gray-50:hover{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\:opacity-80:hover{opacity:0.8}.hover\:opacity-90:hover{opacity:0.9}.hover\:shadow-md:hover{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hover\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}.md\:grid-cols-5{grid-template-columns:repeat(5, minmax(0, 1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}@media (min-width: 1024px){.lg\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.lg\:grid-cols-7{grid-template-columns:repeat(7, minmax(0, 1fr))}.lg\:grid-cols-6{grid-template-columns:repeat(6, minmax(0, 1fr))}}</style>

<!-- 移动端模态框层级修复样式 -->
<style>
/* 移动端模态框层级管理 - 修复重叠问题 */
@media (max-width: 768px) {
    /* 基础模态框层级 */
    #authModal { z-index: 1000 !important; }
    #saveModal { z-index: 1001 !important; }
    #historyModal { z-index: 1002 !important; }
    #importModal { z-index: 1003 !important; }
    #planModal { z-index: 1004 !important; }
    #planSelectionModal { z-index: 1005 !important; }
    
    /* 确保模态框内容在遮罩层之上 */
    #authModal > div,
    #saveModal > div,
    #historyModal > div,
    #importModal > div,
    #planModal > div,
    #planSelectionModal > div {
        position: relative;
        z-index: 1006;
    }
    
    /* 触摸穿透保护 - 防止背景滚动 */
    .modal-open {
        overflow: hidden !important;
        position: fixed;
        width: 100%;
        height: 100%;
    }
    
    /* 点击遮罩层关闭模态框 */
    .fixed.inset-0.bg-black.bg-opacity-50 {
        cursor: pointer;
    }
    
    /* 优化移动端模态框动画 */
    #authModal,
    #saveModal,
    #historyModal,
    #importModal,
    #planModal,
    #planSelectionModal {
        transition: opacity 0.2s ease;
    }
    
    #authModal.hidden,
    #saveModal.hidden,
    #historyModal.hidden,
    #importModal.hidden,
    #planModal.hidden,
    #planSelectionModal.hidden {
        opacity: 0;
        pointer-events: none;
    }
}
</style>
</head>
<body class="bg-vi-gradient min-h-screen">
    <!-- 顶部导航栏：认证状态显示区域 -->
    <div class="fixed top-0 right-3 z-50" id="userNav">
        <!-- 未登录状态 -->
        <div id="authNavGuest" class="flex items-center gap-3">
            <button onclick="showAuthModal('login')" class="bg-white text-primary-red font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-gray-50 transition">
                登录
            </button>
            <button onclick="showAuthModal('register')" class="bg-primary-red text-white font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-primary-red-dark transition">
                注册
            </button>
        </div>
        
        <!-- 已登录状态 -->
        <div id="authNavUser" class="hidden flex items-center gap-3">
            <button onclick="showSaveModal()" class="bg-white text-primary-red font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-gray-50 transition flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                </svg>
                保存项目
            </button>
            <button onclick="showHistoryModal()" class="bg-white text-primary-red font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-gray-50 transition flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                历史记录
            </button>
            <div class="relative group">
                <button id="userMenuBtn" class="bg-primary-red text-white font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-primary-red-dark transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <span id="userDisplayName">用户</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
                <!-- 下拉菜单 - 点击显示 -->
                <div id="userDropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl hidden z-50 border border-gray-200">
                    <div class="py-1">
                        <button onclick="handleLogout()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-100 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            退出登录
                        </button>
                    </div>
                </div>
            </div>
            <!-- 直接退出按钮（备用） -->
            <button onclick="handleLogout()" class="bg-white text-primary-red font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-gray-50 transition flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                </svg>
                退出
            </button>
        </div>
    </div>
    
    <script>
    // 用户菜单下拉交互
    (function() {
        const userMenuBtn = document.getElementById('userMenuBtn');
        const userDropdown = document.getElementById('userDropdown');
        
        if (userMenuBtn && userDropdown) {
            // 点击按钮切换显示
            userMenuBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                userDropdown.classList.toggle('hidden');
            });
            
            // 点击其他地方关闭下拉菜单
            document.addEventListener('click', function(e) {
                if (!userDropdown.contains(e.target) && !userMenuBtn.contains(e.target)) {
                    userDropdown.classList.add('hidden');
                }
            });
            
            // ESC键关闭下拉菜单
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    userDropdown.classList.add('hidden');
                }
            });
        }
        
        // 退出登录处理函数
        window.handleLogout = function() {
            console.log('[handleLogout] 开始执行退出');
            if (window.AppAuth && window.AppAuth.logoutUser) {
                window.AppAuth.logoutUser();
            } else {
                console.error('[handleLogout] AppAuth未加载');
                // 直接调用全局函数
                if (typeof logoutUser === 'function') {
                    logoutUser();
                } else {
                    console.error('[handleLogout] logoutUser函数未定义');
                }
            }
            // 关闭下拉菜单
            if (userDropdown) {
                userDropdown.classList.add('hidden');
            }
        };
    })();
    </script>
    
    <!-- 通知容器 -->
    <div id="notificationContainer" class="fixed top-20 right-4 z-50 space-y-2"></div>
    
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        
        <!-- 新增：Logo和公司信息卡片 -->
        <div class="logo-card mb-4">
            <div class="logo-placeholder">
                <img src="company_logo.png" alt="company_logo">
            </div>
            <div class="company-info">
                <div class="company-name">TECH X 太科斯玻璃隔热膜</div>
                <div class="company-subtitle">无边界新材料科技</div>
            </div>
        </div>
        
        <!-- 原有的主标题卡片 -->
        <div class="bg-primary-gradient rounded-2xl shadow-2xl p-8 mb-8 text-white">
            <div class="flex items-center justify-center mb-2 logo-container">
                <svg class="w-10 h-10 mr-3 logo-icon" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                </svg>
                <h1 class="text-3xl font-bold text-center main-title">玻璃隔热膜智能裁切优化系统</h1>
            </div>
            <p class="text-center text-white opacity-90 text-lg">专业优化算法，精准计算材料利用率，降低成本，提高效率</p>
        </div>

        <!-- 项目基本信息 -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <div class="flex items-center mb-4">
                <svg class="w-6 h-6 mr-2 text-primary-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <h2 class="text-xl font-bold" style="color: var(--secondary-gray);">项目信息</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">项目名称</label>
                    <input type="text" id="projectName" placeholder="请输入项目名称" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">业主姓名</label>
                    <input type="text" id="ownerName" placeholder="请输入业主姓名" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">联系方式</label>
                    <input type="tel" id="contactPhone" placeholder="请输入电话号码" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">项目地址</label>
                    <input type="text" id="projectAddress" placeholder="请输入项目地址" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
            </div>
        </div>

        <!-- 产品类型说明 -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <div class="flex items-center mb-4">
                <svg class="w-6 h-6 mr-2 text-primary-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                </svg>
                <h2 class="text-xl font-bold" style="color: var(--secondary-gray);">产品类型说明</h2>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('晨曦')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #a8e6cf, #88d8b0);"></div>
                    <div class="font-semibold text-sm">晨曦</div>
                    <div class="text-xs text-gray-500">A级膜</div>
                </div>
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('暮语')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #88d8b0, #5cdb95);"></div>
                    <div class="font-semibold text-sm">暮语</div>
                    <div class="text-xs text-gray-500">A级膜</div>
                </div>
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('智幕Pro30')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #5cdb95, #379683);"></div>
                    <div class="font-semibold text-sm">智幕Pro30</div>
                    <div class="text-xs text-gray-500">S级膜</div>
                </div>
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('智幕Pro50')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #379683, #2d6a4f);"></div>
                    <div class="font-semibold text-sm">智幕Pro50</div>
                    <div class="text-xs text-gray-500">S级膜</div>
                </div>
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('智幕Pro70')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #2d6a4f, #1b4332);"></div>
                    <div class="font-semibold text-sm">智幕Pro70</div>
                    <div class="text-xs text-gray-500">S级膜</div>
                </div>
                <div class="text-center p-4 border-2 border-gray-200 rounded-xl hover:border-primary-red transition cursor-pointer" onclick="selectProduct('其他')">
                    <div class="w-12 h-12 mx-auto mb-2 rounded-lg" style="background: linear-gradient(to bottom, #adb5bd, #6c757d);"></div>
                    <div class="font-semibold text-sm">其他</div>
                    <div class="text-xs text-gray-500">其他型号</div>
                </div>
            </div>
        </div>

        <!-- 玻璃数据输入 -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <div class="flex items-center mb-4">
                <svg class="w-6 h-6 mr-2 text-primary-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
                </svg>
                <h2 class="text-xl font-bold" style="color: var(--secondary-gray);">玻璃数据录入</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">楼层</label>
                    <input type="text" id="floor" placeholder="如:一楼/二楼" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">房间/区域</label>
                    <input type="text" id="room" placeholder="如:客厅/主卧" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">窗户编号</label>
                    <input type="text" id="windowId" placeholder="如:A1/西窗1" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">朝向</label>
                    <select id="direction" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                        <option value="南">南</option>
                        <option value="北">北</option>
                        <option value="东">东</option>
                        <option value="西">西</option>
                        <option value="东南">东南</option>
                        <option value="西南">西南</option>
                        <option value="东北">东北</option>
                        <option value="西北">西北</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">产品类型</label>
                    <select id="product" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                        <option value="晨曦">晨曦 (A级膜)</option>
                        <option value="暮语">暮语 (A级膜)</option>
                        <option value="智幕Pro30">智幕Pro30 (S级膜)</option>
                        <option value="智幕Pro50">智幕Pro50 (S级膜)</option>
                        <option value="智幕Pro70">智幕Pro70 (S级膜)</option>
                        <option value="其他">其他</option>
                    </select>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">宽度 (mm)</label>
                    <input type="number" id="width" placeholder="请输入宽度" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">高度 (mm)</label>
                    <input type="number" id="height" placeholder="请输入高度" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div>
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">数量 (片)</label>
                    <input type="number" id="quantity" placeholder="请输入数量" value="1" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
            </div>
            
            <div class="flex flex-wrap gap-3">
                <button onclick="addGlass()" class="bg-primary-red text-white font-semibold px-6 py-2 rounded-lg shadow-lg hover:bg-primary-red-dark transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                    </svg>
                    添加玻璃
                </button>
                <button onclick="clearForm()" class="bg-gray-200 text-gray-700 font-semibold px-6 py-2 rounded-lg shadow-lg hover:bg-gray-300 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                    清空表单
                </button>
                <button onclick="importData()" class="bg-white text-primary-red font-semibold px-6 py-2 rounded-lg border-2 border-primary-red shadow-lg hover:bg-red-50 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                    导入数据
                </button>
                <div class="flex-1"></div>
                <div class="relative group">
                    <button class="bg-white text-primary-red font-semibold px-6 py-2 rounded-lg border-2 border-primary-red shadow-lg hover:bg-red-50 transition flex items-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                        </svg>
                        加载示例
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl hidden z-50 border border-gray-200 group-hover:block">
                        <div class="py-1">
                            <button onclick="loadExample1()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-100">示例1: 家庭别墅</button>
                            <button onclick="loadExample2()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-100">示例2: 商业办公楼</button>
                            <button onclick="loadExample3()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-100">示例3: 高层住宅</button>
                            <button onclick="loadTestCase()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-100">测试用例</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 玻璃列表 -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center">
                    <svg class="w-6 h-6 mr-2 text-primary-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    <h2 class="text-xl font-bold" style="color: var(--secondary-gray);">玻璃清单</h2>
                </div>
                <div class="flex gap-2">
                    <button onclick="exportData()" class="bg-white text-primary-red font-semibold px-4 py-2 rounded-lg border-2 border-primary-red hover:bg-red-50 transition flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                        </svg>
                        导出清单
                    </button>
                    <button onclick="clearAll()" class="bg-gray-200 text-gray-700 font-semibold px-4 py-2 rounded-lg hover:bg-gray-300 transition flex items-center gap-2 text-sm">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        清空全部
                    </button>
                </div>
            </div>
            
            <div id="glassList" class="border-2 border-gray-200 rounded-xl">
                <div class="text-center text-gray-500 py-8">暂无数据，请添加玻璃信息</div>
            </div>
        </div>

        <!-- 优化按钮 -->
        <div class="flex justify-center gap-4 mb-8">
            <button onclick="runOptimization()" class="bg-primary-red text-white font-bold text-xl px-12 py-4 rounded-2xl shadow-2xl hover:bg-primary-red-dark transition flex items-center gap-3">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                </svg>
                执行优化算法
            </button>
        </div>

        <!-- 结果显示区域 -->
        <div id="resultSection" class="hidden">
            <!-- 总体统计 -->
            <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
                <div class="flex items-center mb-4">
                    <svg class="w-6 h-6 mr-2 text-primary-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <h2 class="text-xl font-bold" style="color: var(--secondary-gray);">优化结果统计</h2>
                </div>
                
                <div id="totalStats" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6">
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">玻璃总数</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="totalGlassCount">-</span><span class="text-lg ml-1">块</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">产品类型</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="productTypeCount">-</span><span class="text-lg ml-1">种</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">开卷数</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="totalRollCount">-</span><span class="text-lg ml-1">卷</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">卷材利用率</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="rollUtilization">-</span><span class="text-lg ml-1">%</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">卷材损耗率</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="materialWasteRate">-</span><span class="text-lg ml-1">%</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">玻璃面积</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="totalGlassArea">-</span><span class="text-lg ml-1">m²</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">实际用膜面积</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="totalFilmArea">-</span><span class="text-lg ml-1">m²</span></div>
                    </div>
                    <div class="bg-gray-200 rounded-lg p-4 border border-gray-300">
                        <div class="text-sm font-semibold mb-1" style="color: var(--secondary-gray);">实际用膜长度</div>
                        <div class="font-bold text-2xl" style="color: var(--primary-red);"><span id="totalFilmLength">-</span><span class="text-lg ml-1">m</span></div>
                    </div>
                </div>
                
                <!-- 产品分类统计 -->
                <div id="productStats" class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div class="text-center text-gray-500 py-4">执行优化后显示产品分类统计</div>
                </div>
            </div>

            <!-- 操作按钮 -->
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <button onclick="downloadLog()" class="bg-white text-primary-red font-semibold px-6 py-3 rounded-lg border-2 border-primary-red hover:bg-red-50 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    下载计算日志
                </button>
                <button onclick="exportPDF()" class="bg-white text-primary-red font-semibold px-6 py-3 rounded-lg border-2 border-primary-red hover:bg-red-50 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    导出PDF报告
                </button>
                <button onclick="printReport()" class="bg-white text-primary-red font-semibold px-6 py-3 rounded-lg border-2 border-primary-red hover:bg-red-50 transition flex items-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                    </svg>
                    打印报告
                </button>
            </div>
        </div>

        <!-- 版权信息 -->
        <div class="text-center text-gray-500 text-sm mt-8">
            <p>© 2025 TECH X 太科斯玻璃隔热膜 | 无边界新材料科技</p>
            <p>专业玻璃隔热膜裁切优化解决方案</p>
        </div>
    </div>

    <!-- ==================== 导入模态框 ==================== -->
    <div id="importModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[95vh] overflow-y-auto relative">
            <!-- 关闭按钮 -->
            <button onclick="closeImportModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <div class="bg-primary-gradient text-white p-6 rounded-t-2xl">
                <h2 class="text-2xl font-bold text-center">导入数据</h2>
            </div>
            
            <div class="p-6">
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <label class="block text-sm font-semibold" style="color: var(--secondary-gray);">粘贴数据</label>
                        <button onclick="downloadTemplate()" class="text-primary-red text-sm hover:underline flex items-center gap-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                            </svg>
                            下载模板
                        </button>
                    </div>
                    <textarea id="importTextarea" placeholder="请粘贴数据，每行一条记录&#10;格式: 楼层, 房间, 窗户编号, 朝向, 宽度, 高度, 产品类型, 数量&#10;例如:&#10;一楼, 客厅, A1, 南, 1500, 2000, 晨曦, 2&#10;一楼, 主卧, B1, 东, 1200, 1800, 暮语, 1" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg input-focus font-mono text-sm" rows="8"></textarea>
                </div>
                
                <div class="mb-4 flex gap-4">
                    <label class="flex items-center">
                        <input type="checkbox" id="importAppendMode" class="mr-2">
                        <span class="text-sm">追加到现有数据</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="importSkipHeader" class="mr-2">
                        <span class="text-sm">跳过第一行表头</span>
                    </label>
                </div>
                
                <div class="flex gap-4">
                    <button onclick="previewImportData()" class="flex-1 bg-white text-primary-red font-semibold py-3 px-4 rounded-lg border-2 border-primary-red hover:bg-red-50 transition">
                        预览
                    </button>
                    <button onclick="confirmImportData()" class="flex-1 bg-primary-red text-white font-semibold py-3 px-4 rounded-lg hover:bg-primary-red-dark transition">
                        确认导入
                    </button>
                </div>
                
                <div id="importPreview" class="hidden mt-4">
                    <div id="importPreviewStats" class="mb-2 font-semibold"></div>
                    <div id="importPreviewContent" class="border rounded-lg overflow-auto max-h-64"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== 方案选择模态框 ==================== -->
    <div id="planModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[95vh] overflow-y-auto relative">
            <!-- 关闭按钮 -->
            <button onclick="closePlanModal()" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <div class="bg-primary-gradient text-white p-6 rounded-t-2xl">
                <h2 class="text-2xl font-bold text-center">请选择最优方案</h2>
                <p class="text-center text-white opacity-90 mt-2" id="planModalSubtitle">当前有多种等效方案可供选择</p>
            </div>
            
            <div class="p-6 space-y-6">
                <div id="planComparison" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 方案对比内容将在这里显示 -->
                </div>
                
                <div id="sixPlansDisplay" class="grid grid-cols-1 md:grid-cols-3 gap-4 hidden">
                    <!-- 六种方案显示 -->
                </div>
                
                <div class="flex justify-center gap-4 mt-6">
                    <button onclick="confirmPlanSelection()" class="bg-primary-red text-white font-bold py-3 px-8 rounded-lg hover:bg-primary-red-dark transition">
                        确认选择
                    </button>
                    <button onclick="closePlanModal()" class="bg-gray-200 text-gray-700 font-semibold py-3 px-8 rounded-lg hover:bg-gray-300 transition">
                        取消
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== 认证功能桥接代码 ==================== -->
    <script>
        // 等待AppAuth加载完成后再创建桥接函数
        function initAuthBridge() {
            // 桥接函数：使app.js的函数可在HTML中调用
            window.showAuthModal = function(tab) {
                if (window.AppAuth && window.AppAuth.showAuthModal) {
                    window.AppAuth.showAuthModal(tab);
                } else {
                    console.error('AppAuth未加载');
                }
            };
            
            window.showHistoryModal = function() {
                if (window.AppAuth && window.AppAuth.showHistoryModal) {
                    window.AppAuth.showHistoryModal();
                }
            };
            
            window.showSaveModal = function() {
                if (window.AppAuth && window.AppAuth.showSaveModal) {
                    window.AppAuth.showSaveModal();
                }
            };
            
            window.logoutUser = function() {
                if (window.AppAuth && window.AppAuth.logoutUser) {
                    window.AppAuth.logoutUser();
                }
            };
            
            window.closeModal = function(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.classList.add('hidden');
                }
            };
            
            window.closeAuthModal = function() {
                closeModal('authModal');
            };
            
            window.closeHistoryModal = function() {
                closeModal('historyModal');
            };
            
            window.closeSaveModal = function() {
                closeModal('saveModal');
            };
            
            // 初始化登录状态检查
            if (window.AppAuth && window.AppAuth.checkLoginStatus) {
                setTimeout(function() {
                    window.AppAuth.checkLoginStatus();
                }, 200);
            }
        }
        
        // 立即尝试初始化，如果AppAuth还未加载，则设置定时器检查
        if (window.AppAuth) {
            initAuthBridge();
        } else {
            // 等待AppAuth加载
            let attempts = 0;
            const checkAuth = setInterval(function() {
                attempts++;
                if (window.AppAuth || attempts > 50) {
                    clearInterval(checkAuth);
                    if (window.AppAuth) {
                        initAuthBridge();
                    }
                }
            }, 100);
        }
    </script>

    <!-- ==================== 认证模态框 ==================== -->
    
    <!-- 认证模态框（登录/注册） -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[95vh] overflow-y-auto relative">
            <!-- 关闭按钮 -->
            <button id="authModalClose" class="absolute top-4 right-4 text-white hover:text-gray-200 z-20">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <div class="bg-primary-gradient text-white p-6 rounded-t-2xl">
                <div class="flex justify-center gap-8">
                    <button id="loginTab" class="text-lg font-bold border-b-2 border-white pb-2">登录</button>
                    <button id="registerTab" class="text-lg font-bold border-b-2 border-transparent pb-2 opacity-80">注册</button>
                </div>
            </div>
            
            <div class="p-6">
                <!-- 登录表单 -->
                <form id="loginFormElement">
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">用户名</label>
                        <input type="text" id="loginUsername" placeholder="请输入用户名" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">密码</label>
                        <input type="password" id="loginPassword" placeholder="请输入密码" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                    </div>
                    <button type="submit" class="w-full bg-primary-red text-white font-bold py-3 px-4 rounded-lg transition hover:bg-primary-red-dark">
                        登录
                    </button>
                </form>
                
                <!-- 注册表单 -->
                <form id="registerFormElement" class="hidden">
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">用户名</label>
                        <input type="text" id="registerUsername" placeholder="请输入用户名（至少3个字符）" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">密码</label>
                        <input type="password" id="registerPassword" placeholder="请输入密码（至少6个字符）" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">确认密码</label>
                        <input type="password" id="registerPasswordConfirm" placeholder="请再次输入密码" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                    </div>
                    <button type="submit" class="w-full bg-primary-red text-white font-bold py-3 px-4 rounded-lg transition hover:bg-primary-red-dark">
                        注册
                    </button>
                </form>
                
                <!-- 错误提示 -->
                <div id="authError" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded-lg text-center"></div>
            </div>
        </div>
    </div>
    
    <!-- 保存项目模态框 -->
    <div id="saveModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full relative">
            <!-- 关闭按钮 -->
            <button id="saveModalClose" class="absolute top-4 right-4 text-gray-500 hover:text-gray-700 z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <div class="bg-primary-gradient text-white p-6 rounded-t-2xl">
                <h2 class="text-2xl font-bold text-center">保存项目</h2>
            </div>
            
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">项目名称</label>
                    <input type="text" id="saveProjectName" placeholder="请输入项目名称" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-semibold mb-2" style="color: var(--secondary-gray);">项目描述（可选）</label>
                    <textarea id="saveProjectDescription" placeholder="请输入项目描述" class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg input-focus" rows="3"></textarea>
                </div>
                <div id="saveError" class="hidden mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-center"></div>
            </div>
            
            <div class="p-4 border-t border-gray-200 flex gap-4">
                <button onclick="closeModal('saveModal')" class="flex-1 bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition">
                    取消
                </button>
                <button id="saveAndNewBtn" class="flex-1 bg-white text-primary-red font-semibold py-2 px-4 rounded-lg border-2 border-primary-red hover:bg-red-50 transition">
                    保存并新建
                </button>
                <button id="saveConfirmBtn" class="flex-1 bg-primary-red text-white font-semibold py-2 px-4 rounded-lg hover:bg-primary-red-dark transition">
                    保存
                </button>
            </div>
        </div>
    </div>
    
    <!-- 历史记录模态框 -->
    <div id="historyModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 hidden">
        <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[95vh] overflow-y-auto relative">
            <div class="sticky top-0 bg-primary-red text-white p-6 rounded-t-2xl z-10 flex justify-between items-center">
                <h2 class="text-2xl font-bold">我的项目</h2>
                <button id="historyModalClose" class="text-white hover:text-gray-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6">
                <div id="projectListContainer" class="space-y-4">
                    <div class="text-center text-gray-500 py-8">加载中...</div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>